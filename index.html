<style>
    #input {
        position: absolute;
        bottom: 1px;
        left: 0;
        height: 50px;
        width: 90%;
        resize: none;
        font-size: 20px;
    }
    #input:focus {
        outline: none;
    }
    #sendButton {
        position: absolute;
        bottom: 1px;
        right: 0;
        height: 50px;
        width: 10%;
        background-color: #4CAF50;
        color: black;
        font-size: 20px;
        cursor: pointer;
    }

    .message {
        display: grid;
        width: 100%;
        grid-template-columns: min-content min-content;
        border: 1px solid black;
    }

    #messages {
        /*make it so the messages start at the bottom when appended */
        display: flex;
        flex-direction: column-reverse;
        height: 94%;
    }
    #time-Date {
        grid-column: 1 / 3;
    }
</style>
<head>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div id="messages">
    </div>
    <textarea id="input"></textarea>
    <div id="sendButton">Send</div>
</body>
<script>
    var socket = io();
    let userID = undefined;

    const input = document.getElementById('input');
    const sendButton = document.getElementById('sendButton');

    function createNewMessage(user, time, date, message){
        let newMessage = document.createElement('div');
        newMessage.classList.add('message');
        newMessage.title = `${date} at ${time}`;
        newMessage.innerHTML = `
            <div style="display: grid;">
                <div id="name" style="white-space: nowrap;">
                    ${user} says:
                </div>
            </div>
            <br>
            <div id="body">${message}</div>
        `;
        return newMessage;
    }

    sendButton.addEventListener('click', () => {
        let _date = new Date();
        // get the date in this format:
        // sent on HH:MM:SS on MM DD, YYYY
        let date = `${_date.getDate()}/${_date.getMonth() + 1}/${_date.getFullYear()}`;
        let time = `${_date.getHours()}:${_date.getMinutes()}:${_date.getSeconds()}`
        let clientMessageData = {
            sender: socket.id,
            message: input.value,
            time: time,
            date: date
        }
        socket.emit('clientMessageData', clientMessageData);
        console.log("sent clientMessageData to server")
        input.value = '';
    });

    socket.on('newMessageData', (data) => {
        console.log("received newMessageData from server");
        let newMessage = createNewMessage(data.sender, data.time, data.date, data.message);
        document.getElementById('messages').prepend(newMessage);
    });
</script>